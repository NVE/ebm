steps:
  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        set -e  # Exit immediately if a command exits with a non-zero status
        python -m pip install --upgrade pip
        python -m pip install setuptools build
        python -m pip install .[dev]
    displayName: 'Install dependencies ğŸ§³'

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        python -m pip install pytest pytest-azurepipelines
        pytest --junitxml=TEST-results.xml
    displayName: 'Run pytest ğŸ§ª'

  - task: PublishTestResults@2
    inputs:
      testResultsFiles: '**/TEST-results.xml'
      testRunTitle: 'Pytest Results'
    condition: succeededOrFailed()
    displayName: 'Publish test results ğŸ“Š'

  - task: Bash@3
    inputs:
      targetType: 'inline'

      script: |
        rm -rf dist/ build/
        python -m build
    displayName: 'Build package ğŸ—ï¸'

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        echo "ğŸ“¦ Build artifacts:"
        ls -lh dist/
    displayName: 'List build artifacts ğŸ“¦'


