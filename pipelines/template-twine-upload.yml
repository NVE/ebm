steps:
  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        cat ebm/__version__.py
    displayName: 'Show version 🦉'

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        pip install twine
    displayName: 'Install Twine 🔨'

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        rm -rf dist/ build/ ebm.egg-info/
        python -m build
    displayName: 'Build package 🏗️'

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        echo "📦 Build artifacts:"
        ls -lh dist/
    displayName: 'List build artifacts 📦'

  - task: Bash@3
    inputs:
      targetType: 'inline'
      script: |
        python -m twine upload dist/* --username="$(PYPI_USERNAME)" --password="$(PYPI_PASSWORD)" --repository="$(PYPI_REPOSITORY)"
    displayName: 'Publish to $(PYPI_REPOSITORY) 📰'
